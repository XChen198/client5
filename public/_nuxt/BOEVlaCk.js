import{E as F}from"./B1sV65LB.js";import{E as M,a as k}from"./CNSLevp2.js";import{E as C}from"./NkgphkwY.js";import{_ as S}from"./BQU9x2pH.js";import{E as c}from"./BrhpWW4a.js";import{f as I,g as N,r as w,J as h,h as T,c as v,b as o,w as s,N as q,o as y,k as B,d as i,a as f,p as U,e as $}from"./Dh4ENSPc.js";import{_ as H}from"./DlAUqK2U.js";import"./BGpyNCB4.js";import"./CoS429Et.js";import"./iEayIuJa.js";import"./r5W6hzzQ.js";const L=d=>(U("data-v-3529130c"),d=d(),$(),d),R=L(()=>f("h1",null,"注册",-1)),J=["innerHTML"],O={class:"goHome"},D={class:"goLogin"},G=I({__name:"index",setup(d){const V=N(),u=w(""),m=w(),r=h({username:"",password:"",confirmPassword:"",captcha:""});T(()=>{p()});const x=h({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:(a,e,t)=>{e===""?t(new Error("密码不能为空")):e.length<6?t(new Error("密码长度不能小于6位")):t()},trigger:"blur"}],confirmPassword:[{required:!0,message:"请再输入一次密码",trigger:"blur"},{validator:(a,e,t)=>{e===""?t(new Error("请再输入一次密码")):e!==r.password?t(new Error("两次输入密码不一致")):t()},trigger:"blur"}],captcha:[{required:!0,message:"请输入验证码",trigger:"blur"},{min:4,max:4,message:"验证码长度为4",trigger:"blur"}]}),E=a=>{a&&a.validate(async e=>{if(e)try{const t=await $fetch("https://nyknow.com/api/auth/signup",{method:"POST",credentials:"include",body:JSON.stringify({username:r.username,password:r.password,confirmPassword:r.confirmPassword,captcha:r.captcha})});t.code===0?(c.success(t.message),V.push("/login")):(c.error(t.message),p())}catch{c.error("注册失败,请稍后再试")}})},b=a=>{a&&a.resetFields()},p=async()=>{const e=await(await $fetch("https://nyknow.com/api/auth/captcha",{method:"GET",credentials:"include"})).text();u.value=e};return(a,e)=>{const t=F,n=k,_=C,g=S,P=M;return y(),v(q,null,[R,o(P,{ref_key:"ruleFormRef",ref:m,model:r,rules:x,style:{"max-width":"600px",margin:"0 auto"},"label-width":"auto"},{default:s(()=>[o(n,{label:"用户名 :",prop:"username"},{default:s(()=>[o(t,{modelValue:r.username,"onUpdate:modelValue":e[0]||(e[0]=l=>r.username=l),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),o(n,{label:"密码 :",prop:"password"},{default:s(()=>[o(t,{modelValue:r.password,"onUpdate:modelValue":e[1]||(e[1]=l=>r.password=l),modelModifiers:{trim:!0},type:"password"},null,8,["modelValue"])]),_:1}),o(n,{label:"确认密码 :",prop:"confirmPassword"},{default:s(()=>[o(t,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=l=>r.confirmPassword=l),modelModifiers:{trim:!0},type:"password"},null,8,["modelValue"])]),_:1}),u.value?(y(),v("div",{key:0,innerHTML:u.value,onClick:p,class:"captchaSvg"},null,8,J)):B("",!0),o(n,{label:"验证码 :",prop:"captcha"},{default:s(()=>[o(t,{modelValue:r.captcha,"onUpdate:modelValue":e[3]||(e[3]=l=>r.captcha=l),modelModifiers:{trim:!0},type:"text"},null,8,["modelValue"])]),_:1}),o(n,null,{default:s(()=>[o(_,{type:"primary",onClick:e[4]||(e[4]=l=>E(m.value)),style:{width:"100%"}},{default:s(()=>[i("注册")]),_:1})]),_:1}),o(n,null,{default:s(()=>[o(_,{onClick:e[5]||(e[5]=l=>b(m.value)),style:{width:"100%"}},{default:s(()=>[i("重置")]),_:1})]),_:1}),f("span",O,[o(g,{to:"/"},{default:s(()=>[i("返回首页")]),_:1})]),f("span",D,[i("已有账号? "),o(g,{to:"/login"},{default:s(()=>[i("去登录")]),_:1})])]),_:1},8,["model","rules"])],64)}}}),se=H(G,[["__scopeId","data-v-3529130c"]]);export{se as default};
