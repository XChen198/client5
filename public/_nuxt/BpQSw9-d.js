import{_ as Ne}from"./BQU9x2pH.js";import{f as ke,a as xe,E as Se}from"./CeaJMaa7.js";import{E as Be}from"./ne-LEtTm.js";import{E as Oe}from"./D_Fmugrb.js";import{E as Re}from"./2NZr4Mmw.js";import{E as ze}from"./AEnOYdjy.js";import{b as X,d as le,m as me,t as re,u as _e,_ as he,c as Ae,e as Le,a as G,f as Ve,g as Fe,h as Ie,i as H,p as Me,w as De,j as Ke,E as D}from"./BrhpWW4a.js";import{s as Ue,l as je,f as I,m as ce,n as Y,r as p,q as F,v as ie,o as V,c as W,x as ye,j as O,y as We,z as Q,A as J,h as ue,B as qe,b as s,C as Ge,D as oe,E as de,F as He,G as Je,H as Xe,I as fe,J as Ye,K as Qe,L as Ze,M as et,k as tt,w as y,N as se,O as ve,i as be,d as L,t as j,p as at,e as st,a as nt}from"./Dh4ENSPc.js";import{c as R}from"./BP04w6uM.js";import{U as ge}from"./B1sV65LB.js";import"./vQi6h-p6.js";import{_ as ot}from"./DlAUqK2U.js";import"./CoS429Et.js";import"./B_pKZ7vX.js";import"./BGpyNCB4.js";const lt=(e,r,d)=>ke(e.subTree).filter(t=>{var v;return je(t)&&((v=t.type)==null?void 0:v.name)===r&&!!t.component}).map(t=>t.component.uid).map(t=>d[t]).filter(t=>!!t),rt=(e,r)=>{const d={},g=Ue([]);return{children:g,addChild:v=>{d[v.uid]=v,g.value=lt(e,r,d)},removeChild:v=>{delete d[v],g.value=g.value.filter(N=>N.uid!==v)}}},Z=Symbol("tabsRootContextKey"),ct=X({tabs:{type:le(Array),default:()=>me([])}}),Ce="ElTabBar",it=I({name:Ce}),ut=I({...it,props:ct,setup(e,{expose:r}){const d=e,g=Q(),f=ce(Z);f||re(Ce,"<el-tabs><el-tab-bar /></el-tabs>");const t=Y("tabs"),v=p(),N=p(),b=()=>{let u=0,E=0;const m=["top","bottom"].includes(f.props.tabPosition)?"width":"height",c=m==="width"?"x":"y",S=c==="x"?"left":"top";return d.tabs.every(a=>{var n,T;const _=(T=(n=g.parent)==null?void 0:n.refs)==null?void 0:T[`tab-${a.uid}`];if(!_)return!1;if(!a.active)return!0;u=_[`offset${R(S)}`],E=_[`client${R(m)}`];const k=window.getComputedStyle(_);return m==="width"&&(d.tabs.length>1&&(E-=Number.parseFloat(k.paddingLeft)+Number.parseFloat(k.paddingRight)),u+=Number.parseFloat(k.paddingLeft)),!1}),{[m]:`${E}px`,transform:`translate${R(c)}(${u}px)`}},h=()=>N.value=b();return F(()=>d.tabs,async()=>{await ie(),h()},{immediate:!0}),_e(v,()=>h()),r({ref:v,update:h}),(u,E)=>(V(),W("div",{ref_key:"barRef",ref:v,class:ye([O(t).e("active-bar"),O(t).is(O(f).props.tabPosition)]),style:We(N.value)},null,6))}});var dt=he(ut,[["__file","tab-bar.vue"]]);const ft=X({panes:{type:le(Array),default:()=>me([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),vt={tabClick:(e,r,d)=>d instanceof Event,tabRemove:(e,r)=>r instanceof Event},pe="ElTabNav",bt=I({name:pe,props:ft,emits:vt,setup(e,{expose:r,emit:d}){const g=Q(),f=ce(Z);f||re(pe,"<el-tabs><tab-nav /></el-tabs>");const t=Y("tabs"),v=Ae(),N=Le(),b=p(),h=p(),u=p(),E=p(),m=p(!1),c=p(0),S=p(!1),a=p(!0),n=J(()=>["top","bottom"].includes(f.props.tabPosition)?"width":"height"),T=J(()=>({transform:`translate${n.value==="width"?"X":"Y"}(-${c.value}px)`})),_=()=>{if(!b.value)return;const i=b.value[`offset${R(n.value)}`],o=c.value;if(!o)return;const l=o>i?o-i:0;c.value=l},k=()=>{if(!b.value||!h.value)return;const i=h.value[`offset${R(n.value)}`],o=b.value[`offset${R(n.value)}`],l=c.value;if(i-l<=o)return;const w=i-l>o*2?l+o:i-o;c.value=w},z=async()=>{const i=h.value;if(!m.value||!u.value||!b.value||!i)return;await ie();const o=u.value.querySelector(".is-active");if(!o)return;const l=b.value,w=["top","bottom"].includes(f.props.tabPosition),P=o.getBoundingClientRect(),$=l.getBoundingClientRect(),B=w?i.offsetWidth-$.width:i.offsetHeight-$.height,x=c.value;let C=x;w?(P.left<$.left&&(C=x-($.left-P.left)),P.right>$.right&&(C=x+P.right-$.right)):(P.top<$.top&&(C=x-($.top-P.top)),P.bottom>$.bottom&&(C=x+(P.bottom-$.bottom))),C=Math.max(C,0),c.value=Math.min(C,B)},K=()=>{var i;if(!h.value||!b.value)return;e.stretch&&((i=E.value)==null||i.update());const o=h.value[`offset${R(n.value)}`],l=b.value[`offset${R(n.value)}`],w=c.value;l<o?(m.value=m.value||{},m.value.prev=w,m.value.next=w+l<o,o-w<l&&(c.value=o-l)):(m.value=!1,w>0&&(c.value=0))},q=i=>{const o=i.code,{up:l,down:w,left:P,right:$}=H;if(![l,w,P,$].includes(o))return;const B=Array.from(i.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)")),x=B.indexOf(i.target);let C;o===P||o===l?x===0?C=B.length-1:C=x-1:x<B.length-1?C=x+1:C=0,B[C].focus({preventScroll:!0}),B[C].click(),U()},U=()=>{a.value&&(S.value=!0)},M=()=>S.value=!1;return F(v,i=>{i==="hidden"?a.value=!1:i==="visible"&&setTimeout(()=>a.value=!0,50)}),F(N,i=>{i?setTimeout(()=>a.value=!0,50):a.value=!1}),_e(u,K),ue(()=>setTimeout(()=>z(),0)),qe(()=>K()),r({scrollToActiveTab:z,removeFocus:M}),F(()=>e.panes,()=>g.update(),{flush:"post",deep:!0}),()=>{const i=m.value?[s("span",{class:[t.e("nav-prev"),t.is("disabled",!m.value.prev)],onClick:_},[s(G,null,{default:()=>[s(Ve,null,null)]})]),s("span",{class:[t.e("nav-next"),t.is("disabled",!m.value.next)],onClick:k},[s(G,null,{default:()=>[s(Fe,null,null)]})])]:null,o=e.panes.map((l,w)=>{var P,$,B,x;const C=l.uid,ee=l.props.disabled,te=($=(P=l.props.name)!=null?P:l.index)!=null?$:`${w}`,ae=!ee&&(l.isClosable||e.editable);l.index=`${w}`;const $e=ae?s(G,{class:"is-icon-close",onClick:A=>d("tabRemove",l,A)},{default:()=>[s(Ie,null,null)]}):null,we=((x=(B=l.slots).label)==null?void 0:x.call(B))||l.props.label,Pe=!ee&&l.active?0:-1;return s("div",{ref:`tab-${C}`,class:[t.e("item"),t.is(f.props.tabPosition),t.is("active",l.active),t.is("disabled",ee),t.is("closable",ae),t.is("focus",S.value)],id:`tab-${te}`,key:`tab-${C}`,"aria-controls":`pane-${te}`,role:"tab","aria-selected":l.active,tabindex:Pe,onFocus:()=>U(),onBlur:()=>M(),onClick:A=>{M(),d("tabClick",l,te,A)},onKeydown:A=>{ae&&(A.code===H.delete||A.code===H.backspace)&&d("tabRemove",l,A)}},[we,$e])});return s("div",{ref:u,class:[t.e("nav-wrap"),t.is("scrollable",!!m.value),t.is(f.props.tabPosition)]},[i,s("div",{class:t.e("nav-scroll"),ref:b},[s("div",{class:[t.e("nav"),t.is(f.props.tabPosition),t.is("stretch",e.stretch&&["top","bottom"].includes(f.props.tabPosition))],ref:h,style:T.value,role:"tablist",onKeydown:q},[e.type?null:s(dt,{ref:E,tabs:[...e.panes]},null),o])])])}}}),pt=X({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:le(Function),default:()=>!0},stretch:Boolean}),ne=e=>He(e)||Je(e),mt={[ge]:e=>ne(e),tabClick:(e,r)=>r instanceof Event,tabChange:e=>ne(e),edit:(e,r)=>["remove","add"].includes(r),tabRemove:e=>ne(e),tabAdd:()=>!0},_t=I({name:"ElTabs",props:pt,emits:mt,setup(e,{emit:r,slots:d,expose:g}){var f;const t=Y("tabs"),{children:v,addChild:N,removeChild:b}=rt(Q(),"ElTabPane"),h=p(),u=p((f=e.modelValue)!=null?f:"0"),E=async(a,n=!1)=>{var T,_,k;if(!(u.value===a||de(a)))try{await((T=e.beforeLeave)==null?void 0:T.call(e,a,u.value))!==!1&&(u.value=a,n&&(r(ge,a),r("tabChange",a)),(k=(_=h.value)==null?void 0:_.removeFocus)==null||k.call(_))}catch{}},m=(a,n,T)=>{a.props.disabled||(E(n,!0),r("tabClick",a,T))},c=(a,n)=>{a.props.disabled||de(a.props.name)||(n.stopPropagation(),r("edit",a.props.name,"remove"),r("tabRemove",a.props.name))},S=()=>{r("edit",void 0,"add"),r("tabAdd")};return F(()=>e.modelValue,a=>E(a)),F(u,async()=>{var a;await ie(),(a=h.value)==null||a.scrollToActiveTab()}),Ge(Z,{props:e,currentName:u,registerPane:N,unregisterPane:b}),g({currentName:u}),()=>{const a=d["add-icon"],n=e.editable||e.addable?s("span",{class:t.e("new-tab"),tabindex:"0",onClick:S,onKeydown:k=>{k.code===H.enter&&S()}},[a?oe(d,"add-icon"):s(G,{class:t.is("icon-plus")},{default:()=>[s(Me,null,null)]})]):null,T=s("div",{class:[t.e("header"),t.is(e.tabPosition)]},[n,s(bt,{ref:h,currentName:u.value,editable:e.editable,type:e.type,panes:v.value,stretch:e.stretch,onTabClick:m,onTabRemove:c},null)]),_=s("div",{class:t.e("content")},[oe(d,"default")]);return s("div",{class:[t.b(),t.m(e.tabPosition),{[t.m("card")]:e.type==="card",[t.m("border-card")]:e.type==="border-card"}]},[...e.tabPosition!=="bottom"?[T,_]:[_,T]])}}}),ht=X({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),yt=["id","aria-hidden","aria-labelledby"],Ee="ElTabPane",gt=I({name:Ee}),Ct=I({...gt,props:ht,setup(e){const r=e,d=Q(),g=Xe(),f=ce(Z);f||re(Ee,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const t=Y("tab-pane"),v=p(),N=J(()=>r.closable||f.props.closable),b=fe(()=>{var c;return f.currentName.value===((c=r.name)!=null?c:v.value)}),h=p(b.value),u=J(()=>{var c;return(c=r.name)!=null?c:v.value}),E=fe(()=>!r.lazy||h.value||b.value);F(b,c=>{c&&(h.value=!0)});const m=Ye({uid:d.uid,slots:g,props:r,paneName:u,active:b,index:v,isClosable:N});return ue(()=>{f.registerPane(m)}),Qe(()=>{f.unregisterPane(m.uid)}),(c,S)=>O(E)?Ze((V(),W("div",{key:0,id:`pane-${O(u)}`,class:ye(O(t).b()),role:"tabpanel","aria-hidden":!O(b),"aria-labelledby":`tab-${O(u)}`},[oe(c.$slots,"default")],10,yt)),[[et,O(b)]]):tt("v-if",!0)}});var Te=he(Ct,[["__file","tab-pane.vue"]]);const Et=De(_t,{TabPane:Te}),Tt=Ke(Te),$t=e=>(at("data-v-8ddc5119"),e=e(),st(),e),wt=$t(()=>nt("h1",null,"管理员",-1)),Pt=I({__name:"admin",setup(e){const r=p("first"),d=p(1),g=p(1),f=p(""),t=p(""),v=p([]),N=p([]),b=p(0),h=p(0);ue(async()=>{u(1)});const u=async a=>{try{d.value=a;const n=await $fetch(`https://nyknow.com/api/post/get?currentPage=${d.value}&keyWord=${f.value}&type=${t.value}`,{method:"GET",credentials:"include"});n.code===0&&(v.value=n.data.result,b.value=n.data.total)}catch{D.error("网络错误")}},E=async a=>{try{g.value=a;const n=await $fetch(`https://nyknow.com/api/comment/getAllComments?currentPage=${g.value}`,{method:"GET",credentials:"include"});n.code===0&&(N.value=n.data.comments,h.value=n.data.total)}catch{D.error("网络错误")}},m=a=>{a.props.name==="first"?u(1):E(1)},c=async a=>{try{const n=await $fetch(`https://nyknow.com/api/post/${a}`,{method:"DELETE",credentials:"include"});n.code===0?u(d.value):D.error(n.message)}catch{D.error("网络错误")}},S=async a=>{try{const n=await $fetch(`https://nyknow.com/api/comment/${a}`,{method:"DELETE",credentials:"include"});n.code===0?E(g.value):D.error(n.message)}catch{D.error("网络错误")}};return(a,n)=>{const T=Ne,_=xe,k=Be,z=Oe,K=Se,q=Re,U=ze,M=Tt,i=Et;return V(),W(se,null,[wt,s(i,{modelValue:r.value,"onUpdate:modelValue":n[0]||(n[0]=o=>r.value=o),class:"demo-tabs",onTabClick:m},{default:y(()=>[s(M,{label:"帖子",name:"first"},{default:y(()=>[(V(!0),W(se,null,ve(v.value,o=>(V(),be(q,{key:o._id,class:"mb-2"},{default:y(()=>[s(K,null,{default:y(()=>[s(_,{span:9},{default:y(()=>[s(T,{to:`https://nyknow.com/post/${o._id}`,class:"goPost"},{default:y(()=>[L(j(o.title),1)]),_:2},1032,["to"])]),_:2},1024),s(_,{span:9},{default:y(()=>[s(k,null,{default:y(()=>[L(j(o.updatedAt.split("T")[0]),1)]),_:2},1024)]),_:2},1024),s(_,{span:6,class:"text-right"},{default:y(()=>[s(z,{underline:!1,onClick:l=>c(o._id)},{default:y(()=>[L("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),s(U,{background:"",layout:"prev, pager, next",total:b.value,"page-size":10,"pager-count":5,style:{"justify-content":"center"},onCurrentChange:u},null,8,["total"])]),_:1}),s(M,{label:"评论",name:"second"},{default:y(()=>[(V(!0),W(se,null,ve(N.value,o=>(V(),be(q,{key:o._id,class:"mb-2"},{default:y(()=>[s(K,null,{default:y(()=>[s(_,{span:9},{default:y(()=>[s(T,{to:`/post/${o.postId}`,class:"goPost"},{default:y(()=>[L(j(o.content),1)]),_:2},1032,["to"])]),_:2},1024),s(_,{span:3},{default:y(()=>[L("用户名: "+j(o.username),1)]),_:2},1024),s(_,{span:6},{default:y(()=>[s(k,null,{default:y(()=>[L(j(o.createdAt.split("T")[0]),1)]),_:2},1024)]),_:2},1024),s(_,{span:6,class:"text-right"},{default:y(()=>[s(z,{underline:!1,onClick:l=>S(o._id)},{default:y(()=>[L("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),s(U,{background:"",layout:"prev, pager, next",total:h.value,"page-size":10,"pager-count":5,style:{"justify-content":"center"},onCurrentChange:E},null,8,["total"])]),_:1})]),_:1},8,["modelValue"])],64)}}}),Kt=ot(Pt,[["__scopeId","data-v-8ddc5119"]]);export{Kt as default};
